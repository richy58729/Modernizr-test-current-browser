<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>proxy.php source</title>
</head>
<body>

<a href="../files/proxy.html">Back to proxy.php documentation</a>
<br />
<br />
<hr style="border-bottom-color: #000; border-bottom-width: 1px; margin-left: 0; margin-right: auto; width: 80em" />
<br />

<code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/**<br />&nbsp;*&nbsp;Very&nbsp;simple&nbsp;script&nbsp;to&nbsp;act&nbsp;as&nbsp;proxy&nbsp;to&nbsp;retrieve&nbsp;the&nbsp;Modernizr&nbsp;Documentation&nbsp;web&nbsp;page.<br />&nbsp;*<br />&nbsp;*&nbsp;This&nbsp;script&nbsp;acts&nbsp;as&nbsp;a&nbsp;proxy&nbsp;to&nbsp;retrieve&nbsp;the&nbsp;[Modernizr&nbsp;Documentation](https://modernizr.com/docs).&nbsp;The&nbsp;checks&nbsp;in&nbsp;this<br />&nbsp;*&nbsp;script&nbsp;are&nbsp;simple&nbsp;and&nbsp;fallable&nbsp;checks&nbsp;to&nbsp;prevent&nbsp;misuse.&nbsp;As&nbsp;the&nbsp;scenarios&nbsp;for&nbsp;misuse&nbsp;are&nbsp;rather&nbsp;limited&nbsp;(as&nbsp;in:&nbsp;I<br />&nbsp;*&nbsp;can't&nbsp;imagine&nbsp;this&nbsp;script&nbsp;to&nbsp;be&nbsp;misused&nbsp;in&nbsp;any&nbsp;way,&nbsp;but&nbsp;maybe&nbsp;I&nbsp;lack&nbsp;imagination),&nbsp;I&nbsp;guess&nbsp;these&nbsp;simple&nbsp;checks&nbsp;should<br />&nbsp;*&nbsp;suffice.&nbsp;Hey,&nbsp;at&nbsp;least&nbsp;I&nbsp;have&nbsp;**considered**&nbsp;security&nbsp;and&nbsp;that's&nbsp;more&nbsp;than&nbsp;you&nbsp;can&nbsp;say&nbsp;of&nbsp;most&nbsp;IoT&nbsp;manufacturers...<br />&nbsp;*<br />&nbsp;*&nbsp;&lt;hr&nbsp;style="border-bottom-color:&nbsp;#000;&nbsp;border-bottom-width:&nbsp;1px;&nbsp;margin-left:&nbsp;1em;&nbsp;margin-right:&nbsp;auto;&nbsp;width:&nbsp;80em"&nbsp;/&gt;<br />&nbsp;*<br />&nbsp;*&nbsp;[Jump&nbsp;back&nbsp;to&nbsp;JSDoc](..)<br />&nbsp;*<br />&nbsp;*&nbsp;@author&nbsp;R.J.Vrijhof&nbsp;&lt;r@vrijhof.info&gt;<br />&nbsp;*&nbsp;@license&nbsp;https://opensource.org/licenses/MIT&nbsp;MIT<br />&nbsp;*&nbsp;@package&nbsp;Modernizr-test-current-browser<br />&nbsp;*/<br /><br />//&nbsp;If&nbsp;HTTP_REFERER&nbsp;exists,&nbsp;check&nbsp;if&nbsp;it&nbsp;is&nbsp;one&nbsp;directory&nbsp;up,&nbsp;ending&nbsp;with&nbsp;either&nbsp;a&nbsp;slash&nbsp;or&nbsp;a&nbsp;slash&nbsp;and&nbsp;'index.html'.&nbsp;Also<br />//&nbsp;check&nbsp;if&nbsp;HTTP_X_REQUESTED_WITH&nbsp;is&nbsp;'XMLHttpRequest'&nbsp;(jQuery&nbsp;sends&nbsp;this&nbsp;header&nbsp;when&nbsp;doing&nbsp;a&nbsp;GET&nbsp;AJAX&nbsp;request).<br /></span><span style="color: #007700">if&nbsp;(isset(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'HTTP_REFERER'</span><span style="color: #007700">]))&nbsp;{<br />&nbsp;&nbsp;if&nbsp;(<br />&nbsp;&nbsp;&nbsp;&nbsp;(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'HTTP_REFERER'</span><span style="color: #007700">]&nbsp;===&nbsp;(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'HTTPS'</span><span style="color: #007700">]&nbsp;?&nbsp;</span><span style="color: #DD0000">'https'&nbsp;</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">'http'</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">'://'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'HTTP_HOST'</span><span style="color: #007700">]&nbsp;.&nbsp;</span><span style="color: #0000BB">dirname</span><span style="color: #007700">(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'REQUEST_URI'</span><span style="color: #007700">]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;.&nbsp;</span><span style="color: #DD0000">'/'&nbsp;</span><span style="color: #007700">||<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'HTTP_REFERER'</span><span style="color: #007700">]&nbsp;===&nbsp;(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'HTTPS'</span><span style="color: #007700">]&nbsp;?&nbsp;</span><span style="color: #DD0000">'https'&nbsp;</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">'http'</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">'://'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'HTTP_HOST'</span><span style="color: #007700">]&nbsp;.&nbsp;</span><span style="color: #0000BB">dirname</span><span style="color: #007700">(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'REQUEST_URI'</span><span style="color: #007700">]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;.&nbsp;</span><span style="color: #DD0000">'/index.html'<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">)&nbsp;&amp;&amp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'HTTP_X_REQUESTED_WITH'</span><span style="color: #007700">]&nbsp;===&nbsp;</span><span style="color: #DD0000">'XMLHttpRequest'<br />&nbsp;&nbsp;</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Send&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;Modernizr&nbsp;Documentation&nbsp;page.<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">file_get_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">'https://modernizr.com/docs'</span><span style="color: #007700">);<br />&nbsp;&nbsp;}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Send&nbsp;a&nbsp;forbidden&nbsp;(403)&nbsp;response&nbsp;header&nbsp;(a.k.a.&nbsp;'Fuck&nbsp;off,&nbsp;I&nbsp;don't&nbsp;like&nbsp;you!').<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">http_response_code</span><span style="color: #007700">(</span><span style="color: #0000BB">403</span><span style="color: #007700">);<br />&nbsp;&nbsp;}<br /></span><span style="color: #FF8000">//&nbsp;If&nbsp;HTTP_REFERER&nbsp;doesn't&nbsp;exist,&nbsp;check&nbsp;only&nbsp;HTTP_X_REQUESTED_WITH.<br /></span><span style="color: #007700">}&nbsp;elseif&nbsp;(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'HTTP_X_REQUESTED_WITH'</span><span style="color: #007700">]&nbsp;===&nbsp;</span><span style="color: #DD0000">'XMLHttpRequest'</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Send&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;Modernizr&nbsp;Documentation&nbsp;page.<br />&nbsp;&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">file_get_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">'https://modernizr.com/docs'</span><span style="color: #007700">);<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Send&nbsp;a&nbsp;forbidden&nbsp;(403)&nbsp;response&nbsp;header&nbsp;(a.k.a.&nbsp;'Fuck&nbsp;off,&nbsp;I&nbsp;don't&nbsp;like&nbsp;you!').<br />&nbsp;&nbsp;</span><span style="color: #0000BB">http_response_code</span><span style="color: #007700">(</span><span style="color: #0000BB">403</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code>

</body>
</html>